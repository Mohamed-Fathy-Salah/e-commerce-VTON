def convertWeight(w, gender):
    w = w*100
    female_a = -2.35648430867
    female_b = 1001.43505432
    male_a = -5.28069181198
    male_b = 1056.44071546
    if(gender == 'female'):
        weight = (w - female_a) / female_b
    else:
        weight = (w - male_a) / male_b
    return weight**(1.0 / 3.0)

'''
Measuremnts:
chest_circumference, height,inseam, pelvis_circumference, shoulder_width, waist_circumference,weight
'''
def run(measuremnts, gender):
    measuremnts = {key: float(value) / 100 for key, value in measuremnts.items()}

    coefs = intercept = betas = [0.0]*10

    if(gender == 'female'):
        coefs = [[0.8118823829649713, 5.976566611152309, 6.459990199283558, -2.2026636539095774, 7.647694415803498, -4.023353000029757, 28.253916435606843], [0.9023790748152676, 9.039201683762697, -1.3032244060952056, 1.4586944390523064, -7.154308237278915, -7.482966547812037, -12.249205769619307], [-7.863070469192281, 38.944492511691294, -39.71437567667207, 9.135408822276776, -24.732656993267216, 22.994388129768286, -118.4533193787501], [-4.971958713661899, -17.584202917660626, 27.84561262048449, 11.227251469370284, -45.185714691065144, 17.11481530667062, -33.142402545085766], [-5.411357227697472, 9.585729133807058, -1.3700861194149891, -1.2593760463431627, -25.386547458550776, 26.025144583216107, -76.63632119178], [24.176184261053777, -14.267377965504224, 1.1464669058827321, -8.438439937331914, -29.103201087072236, -56.29963155919151, 200.3791386522453], [30.421107269081617, 0.01895719481861846, 3.1452734404784204, -15.385119140539924, -20.487321748692185, -17.777303373188353, 27.56345080591638], [9.659168437347144, -1.1139997519873406, 3.567430198817442, 7.853961414734773, -5.400285160251275, -8.145273016299429, -19.644337303060496], [-16.570634813698845, 8.760749069554679, -0.4851317982280896, 18.093472493466553, 24.544556646376492, 32.87273398146301, -153.96004746050795], [8.270556774791697, -6.459568935727405, 8.723942955718966, 13.622628982075305, 43.57509996881096, -13.19212000470709, -38.57044331839046]]
        intercept = [-23.818874896975156, -2.62240808705482, -0.5151082073397478, 16.88433837741541, 9.923531362488424, -16.786654668661882, -5.425297654075341, -1.886221285556629, 9.91872378932909, -6.2545770487939425]
        measuremnts['weight'] = convertWeight(measuremnts['weight'], 'female')
    else:
        coefs = [[-1.641924796309873, -9.3248677736079, -2.522335729002137, 0.615212061803641, -4.722739034268763, 0.7968384479425037, -5.488019100805785], [-2.6225769750836703, 8.604015535897268, 1.5905712439955861, 6.089185917930352, -5.947501549916017, -2.1233722704956244, -39.35874903956436], [-16.29087388310385, 16.267264587042458, -18.317339472263384, -2.5285008748365083, -11.22334142735637, 7.594430729129229, 9.183306597774893], [-2.2843382549030418, 9.434511893434488, -15.340391811882451, -3.739935900410189, 26.0231049161014, -14.636591277580763, 35.184531057627574], [-7.868668988487187, 0.25800104679463676, 3.083500947795541, 13.034377737824274, 35.513224255319685, 11.493961300787184, -87.08608500458097], [8.83371659408853, -12.800736631894878, 9.045097937568755, 16.783918645910976, -34.90579658199215, -12.97682029225377, 42.24178356882659], [19.514276944599764, 7.792766787906802, -1.9024599576512458, -20.442198497764984, -44.992871338856474, 10.477374170192807, -25.162238223964753], [1.9585041645597119, 11.698343326467507, -0.47313013784064384, 32.65530893745237, 29.63900280384069, 22.265138867620408, -230.85648350014588], [4.285867080196956, 15.23149119715134, -1.98176522723888, 42.151173474930324, 19.589652286652882, 29.024422920539216, -290.55761536705444], [11.269131494729855, 5.647154390613647, 4.468673940079933, 7.053895469613398, 48.907127761934426, 8.93775994228641, -143.83435961356352]]
        intercept = [23.425288556277376, 1.3806234691960335, -1.2683641558425605, -11.094709764764996, 4.355131387719672, -2.763257876636448, 7.672337683295892, 10.47217752259279, 16.676587956500544, 0.751957250206795]

    measuremnts['weight'] = convertWeight(measuremnts['weight'], gender)

    tmp = [measuremnts['chest'], measuremnts['height'], measuremnts['inseam'], measuremnts['hips'], measuremnts['shoulder'], measuremnts['waist'], measuremnts['weight']]

    for i in range(10):
        products = 0
        for j in range(7):
            products += coefs[i][j] * tmp[j]
        betas[i] = products + intercept[i]

    # shape_params = torch.Tensor([betas])
    return betas
